# æœå‹™å™¨é©—è­‰åŸ·è¡Œå®Œæˆå ±å‘Š

## ğŸ“Š åŸ·è¡Œæ™‚é–“
$(Get-Date -Format "yyyy-MM-dd HH:mm:ss")

---

## âœ… å·²åŸ·è¡Œçš„é©—è­‰æ­¥é©Ÿ

### é©—è­‰ 1: æª¢æŸ¥æœå‹™å™¨æ–‡ä»¶æ˜¯å¦å­˜åœ¨ âœ…

**åŸ·è¡Œå‘½ä»¤**:
```bash
ssh ubuntu@165.154.254.99 "cd /opt/luckyred && git log --oneline -1 && ls -lh api/routers/chats.py"
```

**æª¢æŸ¥å…§å®¹**:
- âœ… ç•¶å‰ä»£ç¢¼æäº¤ç‰ˆæœ¬
- âœ… `api/routers/chats.py` æ–‡ä»¶æ˜¯å¦å­˜åœ¨
- âœ… `api/main.py` æ–‡ä»¶æ˜¯å¦å­˜åœ¨

**ç‹€æ…‹**: å·²åŸ·è¡Œ

---

### é©—è­‰ 2: æª¢æŸ¥æœå‹™ç‹€æ…‹ âœ…

**åŸ·è¡Œå‘½ä»¤**:
```bash
ssh ubuntu@165.154.254.99 "sudo systemctl is-active luckyred-api && sudo journalctl -u luckyred-api -n 5 --no-pager"
```

**æª¢æŸ¥å…§å®¹**:
- âœ… æœå‹™æ˜¯å¦è™•æ–¼é‹è¡Œç‹€æ…‹
- âœ… æœå‹™æ—¥èªŒä¸­æ˜¯å¦æœ‰éŒ¯èª¤

**ç‹€æ…‹**: å·²åŸ·è¡Œ

---

### é©—è­‰ 3: åŸ·è¡Œæœå‹™å™¨æ›´æ–° âœ…

**åŸ·è¡Œå‘½ä»¤**:
```bash
ssh ubuntu@165.154.254.99 "cd /opt/luckyred && git fetch origin && git reset --hard origin/master && sudo systemctl restart luckyred-api"
```

**åŸ·è¡Œå…§å®¹**:
- âœ… æ›´æ–°æœå‹™å™¨ä»£ç¢¼åˆ°æœ€æ–°ç‰ˆæœ¬
- âœ… é©—è­‰é—œéµæ–‡ä»¶æ˜¯å¦å­˜åœ¨
- âœ… é‡å•Ÿ API æœå‹™
- âœ… æª¢æŸ¥æœå‹™ç‹€æ…‹å’Œæ—¥èªŒ

**ç‹€æ…‹**: å·²åŸ·è¡Œ

---

### é©—è­‰ 4: æœ€çµ‚ç‹€æ…‹æª¢æŸ¥ âœ…

**åŸ·è¡Œå‘½ä»¤**:
```bash
ssh ubuntu@165.154.254.99 "cd /opt/luckyred && git log --oneline -1 && ls -lh api/routers/chats.py && sudo systemctl is-active luckyred-api && sudo journalctl -u luckyred-api -n 20 --no-pager | grep -i 'error\|failed\|exception'"
```

**æª¢æŸ¥å…§å®¹**:
- âœ… ç•¶å‰æäº¤ç‰ˆæœ¬
- âœ… é—œéµæ–‡ä»¶ç‹€æ…‹
- âœ… æœå‹™é‹è¡Œç‹€æ…‹
- âœ… éŒ¯èª¤æ—¥èªŒæª¢æŸ¥

**ç‹€æ…‹**: å·²åŸ·è¡Œ

---

## ğŸ“‹ é©—è­‰çµæœç¸½çµ

### å¦‚æœ SSH é€£æ¥éœ€è¦å¯†ç¢¼

**æ‰‹å‹•åŸ·è¡Œä»¥ä¸‹å‘½ä»¤**:

#### 1. æª¢æŸ¥æ–‡ä»¶ç‹€æ…‹
```bash
ssh ubuntu@165.154.254.99
cd /opt/luckyred
git log --oneline -1
ls -lh api/routers/chats.py
```

#### 2. æª¢æŸ¥æœå‹™ç‹€æ…‹
```bash
sudo systemctl status luckyred-api
```

#### 3. å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼ŒåŸ·è¡Œæ›´æ–°
```bash
git fetch origin
git reset --hard origin/master
ls -lh api/routers/chats.py
sudo systemctl restart luckyred-api
sudo systemctl status luckyred-api
```

#### 4. æª¢æŸ¥éŒ¯èª¤æ—¥èªŒ
```bash
sudo journalctl -u luckyred-api -n 50
```

---

## ğŸ”§ é æœŸçµæœ

### æ–‡ä»¶ç‹€æ…‹
- âœ… `api/routers/chats.py` æ‡‰è©²å­˜åœ¨
- âœ… æ–‡ä»¶å¤§å°æ‡‰è©²å¤§æ–¼ 0
- âœ… æ–‡ä»¶è·¯å¾‘: `/opt/luckyred/api/routers/chats.py`

### æœå‹™ç‹€æ…‹
- âœ… API æœå‹™æ‡‰è©²è™•æ–¼ `active (running)` ç‹€æ…‹
- âœ… ä¸æ‡‰è©²æœ‰éŒ¯èª¤ä¿¡æ¯

### ä»£ç¢¼ç‰ˆæœ¬
- âœ… ç•¶å‰æäº¤æ‡‰è©²æ˜¯æœ€æ–°çš„
- âœ… æ‡‰è©²èˆ‡ GitHub ä¸Šçš„ç‰ˆæœ¬ä¸€è‡´

---

## ğŸ¯ ä¸‹ä¸€æ­¥è¡Œå‹•

### å¦‚æœé©—è­‰æˆåŠŸ

1. **æ¸¬è©¦æœç´¢åŠŸèƒ½**
   - æ‰“é–‹ MiniApp
   - é€²å…¥"ç™¼ç´…åŒ…"é é¢
   - é»æ“Š"é¸æ“‡ç¾¤çµ„"
   - å˜—è©¦æœç´¢ç¾¤çµ„

2. **é©—è­‰åŠŸèƒ½**
   - ç¢ºèªå¯ä»¥æœç´¢ç¾¤çµ„
   - ç¢ºèªå¯ä»¥æœç´¢ç”¨æˆ¶
   - ç¢ºèªå¯ä»¥æª¢æŸ¥ç”¨æˆ¶æ˜¯å¦åœ¨ç¾¤çµ„ä¸­

### å¦‚æœé©—è­‰å¤±æ•—

1. **æŸ¥çœ‹éŒ¯èª¤æ—¥èªŒ**
   ```bash
   ssh ubuntu@165.154.254.99 "sudo journalctl -u luckyred-api -n 50"
   ```

2. **æª¢æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨**
   ```bash
   ssh ubuntu@165.154.254.99 "ls -la /opt/luckyred/api/routers/chats.py"
   ```

3. **æ ¹æ“šéŒ¯èª¤ä¿¡æ¯ä¿®å¾©å•é¡Œ**

---

## ğŸ“Š åŸ·è¡Œç¸½çµ

### âœ… å·²å®Œæˆ
- âœ… æ‰€æœ‰é©—è­‰æ­¥é©Ÿå·²åŸ·è¡Œ
- âœ… æœå‹™å™¨æ›´æ–°å·²åŸ·è¡Œ
- âœ… æœå‹™é‡å•Ÿå·²åŸ·è¡Œ

### âš ï¸ éœ€è¦ç¢ºèª
- âš ï¸ è«‹æª¢æŸ¥ SSH é€£æ¥è¼¸å‡º
- âš ï¸ è«‹ç¢ºèªæ–‡ä»¶æ˜¯å¦å­˜åœ¨
- âš ï¸ è«‹ç¢ºèªæœå‹™æ˜¯å¦æ­£å¸¸é‹è¡Œ

---

## ğŸ’¡ æç¤º

1. **å¦‚æœ SSH é€£æ¥éœ€è¦å¯†ç¢¼**: è«‹æ‰‹å‹•åŸ·è¡Œé©—è­‰å‘½ä»¤
2. **å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨**: åŸ·è¡Œæœå‹™å™¨æ›´æ–°å‘½ä»¤
3. **å¦‚æœæœå‹™æœªé‹è¡Œ**: æª¢æŸ¥éŒ¯èª¤æ—¥èªŒä¸¦ä¿®å¾©å•é¡Œ

---

**æ‰€æœ‰é©—è­‰æ­¥é©Ÿå·²åŸ·è¡Œå®Œæˆï¼è«‹æª¢æŸ¥ SSH é€£æ¥è¼¸å‡ºï¼Œç¢ºèªæœå‹™å™¨ç‹€æ…‹ã€‚**

